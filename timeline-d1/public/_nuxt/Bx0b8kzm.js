import{O as N,a3 as te,a4 as ae,a5 as ye,K as E,a6 as he,Q as le,a7 as be,i as f,r as O,F as De,N as q,T as Te,a8 as ne,a9 as R,aa as we,z as n,ab as Ie,X as b,ac as F,ad as ke,ae as K,Z as Se,af as Ce,ag as Pe,ah as Q,ai as xe,aj as _e,_ as Ue,g as Fe,v as I,x as i,ak as v,A as x,a1 as W,$ as _,al as X,a0 as Z,t as V,B as H}from"./CR5yjhbc.js";import{c as Re,m as Ae,d as B,e as Le,f as Me,V as $}from"./BHf_hqC7.js";const ze=N({chips:Boolean,counter:Boolean,counterSizeString:{type:String,default:"$vuetify.fileInput.counterSize"},counterString:{type:String,default:"$vuetify.fileInput.counter"},hideInput:Boolean,multiple:Boolean,showSize:{type:[Boolean,Number,String],default:!1,validator:t=>typeof t=="boolean"||[1e3,1024].includes(Number(t))},...te({prependIcon:"$file"}),modelValue:{type:[Array,Object],default:t=>t.multiple?[]:null,validator:t=>ae(t).every(e=>e!=null&&typeof e=="object")},...ye({clearable:!0})},"VFileInput"),Oe=E()({name:"VFileInput",inheritAttrs:!1,props:ze(),emits:{"click:control":t=>!0,"mousedown:control":t=>!0,"update:focused":t=>!0,"update:modelValue":t=>!0},setup(t,e){let{attrs:c,emit:d,slots:a}=e;const{t:u}=he(),s=le(t,"modelValue",t.modelValue,o=>ae(o),o=>!t.multiple&&Array.isArray(o)?o[0]:o),{isFocused:l,focus:A,blur:L}=be(t),k=f(()=>typeof t.showSize!="boolean"?t.showSize:void 0),y=f(()=>(s.value??[]).reduce((o,r)=>{let{size:D=0}=r;return o+D},0)),h=f(()=>K(y.value,k.value)),p=f(()=>(s.value??[]).map(o=>{const{name:r="",size:D=0}=o;return t.showSize?`${r} (${K(D,k.value)})`:r})),M=f(()=>{var r;const o=((r=s.value)==null?void 0:r.length)??0;return t.showSize?u(t.counterSizeString,o,h.value):u(t.counterString,o)}),S=O(),C=O(),m=O(),oe=f(()=>l.value||t.active),j=f(()=>["plain","underlined"].includes(t.variant));function z(){var o;m.value!==document.activeElement&&((o=m.value)==null||o.focus()),l.value||A()}function ie(o){var r;(r=m.value)==null||r.click()}function se(o){d("mousedown:control",o)}function re(o){var r;(r=m.value)==null||r.click(),d("click:control",o)}function de(o){o.stopPropagation(),z(),Se(()=>{s.value=[],Ce(t["onClick:clear"],o)})}return De(s,o=>{(!Array.isArray(o)||!o.length)&&m.value&&(m.value.value="")}),q(()=>{const o=!!(a.counter||t.counter),r=!!(o||a.details),[D,ue]=ne(c),{modelValue:at,...me}=R.filterProps(t),ce=we(t);return n(R,b({ref:S,modelValue:s.value,"onUpdate:modelValue":T=>s.value=T,class:["v-file-input",{"v-file-input--chips":!!t.chips,"v-file-input--hide":t.hideInput,"v-input--plain-underlined":j.value},t.class],style:t.style,"onClick:prepend":ie},D,me,{centerAffix:!j.value,focused:l.value}),{...a,default:T=>{let{id:P,isDisabled:w,isDirty:G,isReadonly:Y,isValid:ge}=T;return n(Ie,b({ref:C,"prepend-icon":t.prependIcon,onMousedown:se,onClick:re,"onClick:clear":de,"onClick:prependInner":t["onClick:prependInner"],"onClick:appendInner":t["onClick:appendInner"]},ce,{id:P.value,active:oe.value||G.value,dirty:G.value||t.dirty,disabled:w.value,focused:l.value,error:ge.value===!1}),{...a,default:fe=>{var J;let{props:{class:pe,...ve}}=fe;return n(F,null,[n("input",b({ref:m,type:"file",readonly:Y.value,disabled:w.value,multiple:t.multiple,name:t.name,onClick:g=>{g.stopPropagation(),Y.value&&g.preventDefault(),z()},onChange:g=>{if(!g.target)return;const Ve=g.target;s.value=[...Ve.files??[]]},onFocus:z,onBlur:L},ve,ue),null),n("div",{class:pe},[!!((J=s.value)!=null&&J.length)&&!t.hideInput&&(a.selection?a.selection({fileNames:p.value,totalBytes:y.value,totalBytesReadable:h.value}):t.chips?p.value.map(g=>n(Re,{key:g,size:"small",text:g},null)):p.value.join(", "))])])}})},details:r?T=>{var P,w;return n(F,null,[(P=a.details)==null?void 0:P.call(a,T),o&&n(F,null,[n("span",null,null),n(ke,{active:!!((w=s.value)!=null&&w.length),value:M.value,disabled:t.disabled},a.counter)])])}:void 0})}),Te({},S,C,m)}}),Be=N({...Ae({falseIcon:"$radioOff",trueIcon:"$radioOn"})},"VRadio"),U=E()({name:"VRadio",props:Be(),setup(t,e){let{slots:c}=e;return q(()=>{const d=B.filterProps(t);return n(B,b(d,{class:["v-radio",t.class],style:t.style,type:"radio"}),c)}),{}}}),Ne=N({height:{type:[Number,String],default:"auto"},...te(),...Pe(Le(),["multiple"]),trueIcon:{type:Q,default:"$radioOn"},falseIcon:{type:Q,default:"$radioOff"},type:{type:String,default:"radio"}},"VRadioGroup"),ee=E()({name:"VRadioGroup",inheritAttrs:!1,props:Ne(),emits:{"update:modelValue":t=>!0},setup(t,e){let{attrs:c,slots:d}=e;const a=xe(),u=f(()=>t.id||`radio-group-${a}`),s=le(t,"modelValue");return q(()=>{const[l,A]=ne(c),L=R.filterProps(t),k=B.filterProps(t),y=d.label?d.label({label:t.label,props:{for:u.value}}):t.label;return n(R,b({class:["v-radio-group",t.class],style:t.style},l,L,{modelValue:s.value,"onUpdate:modelValue":h=>s.value=h,id:u.value}),{...d,default:h=>{let{id:p,messagesId:M,isDisabled:S,isReadonly:C}=h;return n(F,null,[y&&n(_e,{id:p.value},{default:()=>[y]}),n(Me,b(k,{id:p.value,"aria-describedby":M.value,defaultsTarget:"VRadio",trueIcon:t.trueIcon,falseIcon:t.falseIcon,type:t.type,disabled:S.value,readonly:C.value,"aria-labelledby":y?p.value:void 0,multiple:!1},A,{modelValue:s.value,"onUpdate:modelValue":m=>s.value=m}),d)])}})}),{}}}),Ee={name:"NewEvent",data(){return{loggedIn:!1,username:"",password:"",correctUsername:"timeline-admin",correctPassword:"19391945",existingTags:[],mainTagSelectionType:"select",eventType:"moment",today:new Date().toISOString(),loading:!1,fetchPrefix:"",formData:{name:"",description:"",date:null,startDate:null,endDate:null,selectedMainTag:"",createdMainTag:"",selectedTags:[],createdTags:"",mapLink:"",image:null}}},methods:{async submitEvent(){this.loading=!0;const t=this.getPayload();if(this.formData.image){const e=new FormData;e.append("image",this.formData.image);const a=(await(await fetch(`${this.fetchPrefix}image-upload`,{method:"POST",body:e})).json()).image_id;t.image=a}await fetch(`${this.fetchPrefix}create-new-event`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),this.loading=!1,this.$router.push("/thank-you")},getPayload(){const t={name:this.formData.name,description:this.formData.description,embed_link:this.formData.mapLink?this.formData.mapLink.split('"')[1]:"",tags:this.formData.selectedTags.map(e=>parseInt(e))||[],new_tags:this.getNewTags(),main_tag_id:parseInt(this.formData.selectedMainTag)||"",new_main_tag:this.capitalizeFirstLetter(this.formData.createdMainTag.trim().toLowerCase())||""};return this.eventType==="moment"?t.start_date=this.getDate(this.formData.date):(t.start_date=this.getDate(this.formData.startDate),t.end_date=this.getDate(this.formData.endDate)),t},capitalizeFirstLetter(t){return t?t.charAt(0).toUpperCase()+t.slice(1).toLowerCase():""},getDate(t){const e=new Date(t);return new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())).toISOString()},getNewTags(){return this.formData.createdTags?this.formData.createdTags.includes(",")?this.formData.createdTags.split(",").map(t=>this.capitalizeFirstLetter(t.trim().toLowerCase())):[this.capitalizeFirstLetter(this.formData.createdTags.trim().toLowerCase())]:""},loginClicked(){this.username===this.correctUsername&&this.password===this.correctPassword?(localStorage.setItem("isLoggedInToTimeline","true"),this.loggedIn=this.isLoggedIn(),this.$emit("loggedInChanged",this.loggedIn)):alert("Incorrect username or password")},isLoggedIn(){return localStorage.getItem("isLoggedInToTimeline")==="true"},async setTags(){await fetch(`${this.fetchPrefix}tags`).then(t=>t.json()).then(t=>{this.existingTags=t.map(e=>({value:e.id.toString(),title:e.name}))})}},async created(){this.fetchPrefix="/",this.loggedIn=this.isLoggedIn(),await this.setTags()}},qe={key:0,class:"login_container"},je={class:"login_box"},Ge={key:0,class:"form_container"},Ye={class:""},Je={class:"optional_information_container"},Ke={class:"map_container"},Qe={key:0,class:"moment_date"},We={key:1,class:"range_dates"},Xe={class:"tags_container"},Ze={class:"main_tag_container"},He={class:"tag_content"},$e={class:"tags"},et={class:"tag_content"};function tt(t,e,c,d,a,u){const s=Fe("v-date-input");return V(),I("div",null,[i("form",{onSubmit:e[2]||(e[2]=X((...l)=>u.loginClicked&&u.loginClicked(...l),["prevent"]))},[a.loggedIn?_("",!0):(V(),I("div",qe,[i("div",je,[n(v,{id:"username",modelValue:a.username,"onUpdate:modelValue":e[0]||(e[0]=l=>a.username=l),width:"20rem",label:"Username",name:"username"},null,8,["modelValue"]),n(v,{id:"password",modelValue:a.password,"onUpdate:modelValue":e[1]||(e[1]=l=>a.password=l),width:"20rem",label:"Password",type:"password",name:"password"},null,8,["modelValue"]),n(W,{class:"submit_btn",color:"#5865f2",width:"8rem",type:"submit",block:""},{default:x(()=>e[17]||(e[17]=[H("Submit")])),_:1})])]))],32),a.loggedIn?(V(),I("div",Ge,[e[29]||(e[29]=i("h1",null,"Add New Event",-1)),i("form",{onSubmit:e[16]||(e[16]=X((...l)=>u.submitEvent&&u.submitEvent(...l),["prevent"]))},[e[24]||(e[24]=i("p",null,"I want to create a new event! Yay! What's the event type?",-1)),n(ee,{modelValue:a.eventType,"onUpdate:modelValue":e[3]||(e[3]=l=>a.eventType=l),inline:""},{default:x(()=>[n(U,{label:"Moment (an event that points to a specific date)",value:"moment"}),n(U,{label:"Range (an event that has different start and end dates)",value:"range"})]),_:1},8,["modelValue"]),e[25]||(e[25]=i("h2",{class:"section_title"},"Information",-1)),i("div",Ye,[n(v,{id:"name",modelValue:a.formData.name,"onUpdate:modelValue":e[4]||(e[4]=l=>a.formData.name=l),label:"Event Name","max-width":"30rem",name:"name",required:""},null,8,["modelValue"])]),i("div",null,[n(v,{id:"description",modelValue:a.formData.description,"onUpdate:modelValue":e[5]||(e[5]=l=>a.formData.description=l),label:"Event Description",name:"description"},null,8,["modelValue"])]),e[26]||(e[26]=i("h3",{class:"subsection_title"},"Optional Information",-1)),i("div",Je,[n(Oe,{id:"image",modelValue:a.formData.image,"onUpdate:modelValue":e[6]||(e[6]=l=>a.formData.image=l),class:"file_input",label:"Optional: Image",name:"image"},null,8,["modelValue"]),i("div",Ke,[n(v,{id:"map_link",modelValue:a.formData.mapLink,"onUpdate:modelValue":e[7]||(e[7]=l=>a.formData.mapLink=l),label:"Optional: Map Link",name:"map_link"},null,8,["modelValue"]),e[18]||(e[18]=i("p",null,"If you want the event to include a google map, please go to google maps and search for the location. Then click the 'share' icon and go to the 'Embed a map' tab. Copy the provided link and paste it here.",-1))])]),e[27]||(e[27]=i("h2",{class:"section_title"},"Dates",-1)),i("div",null,[a.eventType==="moment"?(V(),I("div",Qe,[n(s,{id:"moment_date",modelValue:a.formData.date,"onUpdate:modelValue":e[8]||(e[8]=l=>a.formData.date=l),max:a.today,required:"",label:"Date",width:"20rem",name:"moment_date"},null,8,["modelValue","max"])])):(V(),I("div",We,[n(s,{id:"start_date",modelValue:a.formData.startDate,"onUpdate:modelValue":e[9]||(e[9]=l=>a.formData.startDate=l),max:a.today,required:"",label:"Start Date",width:"20rem",name:"start_date"},null,8,["modelValue","max"]),n(s,{id:"end_date",modelValue:a.formData.endDate,"onUpdate:modelValue":e[10]||(e[10]=l=>a.formData.endDate=l),max:a.today,required:"",label:"End Date",width:"20rem",name:"end_date"},null,8,["modelValue","max"])]))]),e[28]||(e[28]=i("h2",{class:"section_title"},"Tags",-1)),i("div",Xe,[e[21]||(e[21]=i("h3",{class:"subsection_title"},"Main Tag",-1)),i("div",Ze,[n(ee,{modelValue:a.mainTagSelectionType,"onUpdate:modelValue":e[11]||(e[11]=l=>a.mainTagSelectionType=l),inline:""},{default:x(()=>[n(U,{label:"Select an existing tag",value:"select"}),n(U,{label:"Create a new tag",value:"create"})]),_:1},8,["modelValue"]),i("div",He,[a.existingTags.length?(V(),Z($,{key:0,id:"main_tag",modelValue:a.formData.selectedMainTag,"onUpdate:modelValue":e[12]||(e[12]=l=>a.formData.selectedMainTag=l),required:a.mainTagSelectionType==="select",label:"Select an existing tag",disabled:a.mainTagSelectionType==="create",items:a.existingTags},null,8,["modelValue","required","disabled","items"])):_("",!0),e[19]||(e[19]=i("p",{class:"or"},"OR",-1)),n(v,{id:"main_tag",modelValue:a.formData.createdMainTag,"onUpdate:modelValue":e[13]||(e[13]=l=>a.formData.createdMainTag=l),required:a.mainTagSelectionType==="create",label:"Create a new tag",disabled:a.mainTagSelectionType==="select"},null,8,["modelValue","required","disabled"])])]),e[22]||(e[22]=i("h3",{class:"subsection_title"},"Other Tags",-1)),i("div",$e,[i("div",et,[a.existingTags.length?(V(),Z($,{key:0,modelValue:a.formData.selectedTags,"onUpdate:modelValue":e[14]||(e[14]=l=>a.formData.selectedTags=l),class:"tags_selection",items:a.existingTags,label:"Tags",multiple:""},null,8,["modelValue","items"])):_("",!0),i("div",null,[n(v,{id:"new_tags",modelValue:a.formData.createdTags,"onUpdate:modelValue":e[15]||(e[15]=l=>a.formData.createdTags=l),label:"Add new tags"},null,8,["modelValue"]),e[20]||(e[20]=i("p",null,"Add as many tags as you wish. Use a comma as a separator. For example: war, Germany, battle",-1))])])])]),n(W,{class:"submit_btn",color:"#5865f2",width:"20rem",type:"submit",loading:a.loading,block:""},{default:x(()=>e[23]||(e[23]=[H("Submit")])),_:1},8,["loading"])],32)])):_("",!0)])}const ot=Ue(Ee,[["render",tt],["__scopeId","data-v-05413033"]]);export{ot as default};
