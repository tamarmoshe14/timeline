import{O as z,a3 as te,a4 as ae,a5 as ye,K as E,a6 as be,Q as le,a7 as De,i as f,r as L,F as he,N as q,T as Te,a8 as ne,a9 as A,aa as we,z as n,ab as Ie,X as D,ac as R,ad as ke,ae as K,Z as Se,af as Ce,ag as Pe,ah as Q,ai as _e,aj as xe,_ as Ue,g as Re,v as I,x as s,ak as v,A as _,$ as W,a0 as x,al as X,a1 as Z,t as V,B as H}from"./C9nMp9z-.js";import{a as Ae,m as Fe,b as N,c as Me,d as Oe,V as $}from"./t0B191Gs.js";const Be=z({chips:Boolean,counter:Boolean,counterSizeString:{type:String,default:"$vuetify.fileInput.counterSize"},counterString:{type:String,default:"$vuetify.fileInput.counter"},hideInput:Boolean,multiple:Boolean,showSize:{type:[Boolean,Number,String],default:!1,validator:t=>typeof t=="boolean"||[1e3,1024].includes(Number(t))},...te({prependIcon:"$file"}),modelValue:{type:[Array,Object],default:t=>t.multiple?[]:null,validator:t=>ae(t).every(e=>e!=null&&typeof e=="object")},...ye({clearable:!0})},"VFileInput"),Le=E()({name:"VFileInput",inheritAttrs:!1,props:Be(),emits:{"click:control":t=>!0,"mousedown:control":t=>!0,"update:focused":t=>!0,"update:modelValue":t=>!0},setup(t,e){let{attrs:c,emit:d,slots:a}=e;const{t:u}=be(),i=le(t,"modelValue",t.modelValue,o=>ae(o),o=>!t.multiple&&Array.isArray(o)?o[0]:o),{isFocused:l,focus:F,blur:M}=De(t),k=f(()=>typeof t.showSize!="boolean"?t.showSize:void 0),y=f(()=>(i.value??[]).reduce((o,r)=>{let{size:h=0}=r;return o+h},0)),b=f(()=>K(y.value,k.value)),p=f(()=>(i.value??[]).map(o=>{const{name:r="",size:h=0}=o;return t.showSize?`${r} (${K(h,k.value)})`:r})),O=f(()=>{var r;const o=((r=i.value)==null?void 0:r.length)??0;return t.showSize?u(t.counterSizeString,o,b.value):u(t.counterString,o)}),S=L(),C=L(),m=L(),oe=f(()=>l.value||t.active),j=f(()=>["plain","underlined"].includes(t.variant));function B(){var o;m.value!==document.activeElement&&((o=m.value)==null||o.focus()),l.value||F()}function se(o){var r;(r=m.value)==null||r.click()}function ie(o){d("mousedown:control",o)}function re(o){var r;(r=m.value)==null||r.click(),d("click:control",o)}function de(o){o.stopPropagation(),B(),Se(()=>{i.value=[],Ce(t["onClick:clear"],o)})}return he(i,o=>{(!Array.isArray(o)||!o.length)&&m.value&&(m.value.value="")}),q(()=>{const o=!!(a.counter||t.counter),r=!!(o||a.details),[h,ue]=ne(c),{modelValue:at,...me}=A.filterProps(t),ce=we(t);return n(A,D({ref:S,modelValue:i.value,"onUpdate:modelValue":T=>i.value=T,class:["v-file-input",{"v-file-input--chips":!!t.chips,"v-file-input--hide":t.hideInput,"v-input--plain-underlined":j.value},t.class],style:t.style,"onClick:prepend":se},h,me,{centerAffix:!j.value,focused:l.value}),{...a,default:T=>{let{id:P,isDisabled:w,isDirty:G,isReadonly:Y,isValid:ge}=T;return n(Ie,D({ref:C,"prepend-icon":t.prependIcon,onMousedown:ie,onClick:re,"onClick:clear":de,"onClick:prependInner":t["onClick:prependInner"],"onClick:appendInner":t["onClick:appendInner"]},ce,{id:P.value,active:oe.value||G.value,dirty:G.value||t.dirty,disabled:w.value,focused:l.value,error:ge.value===!1}),{...a,default:fe=>{var J;let{props:{class:pe,...ve}}=fe;return n(R,null,[n("input",D({ref:m,type:"file",readonly:Y.value,disabled:w.value,multiple:t.multiple,name:t.name,onClick:g=>{g.stopPropagation(),Y.value&&g.preventDefault(),B()},onChange:g=>{if(!g.target)return;const Ve=g.target;i.value=[...Ve.files??[]]},onFocus:B,onBlur:M},ve,ue),null),n("div",{class:pe},[!!((J=i.value)!=null&&J.length)&&!t.hideInput&&(a.selection?a.selection({fileNames:p.value,totalBytes:y.value,totalBytesReadable:b.value}):t.chips?p.value.map(g=>n(Ae,{key:g,size:"small",text:g},null)):p.value.join(", "))])])}})},details:r?T=>{var P,w;return n(R,null,[(P=a.details)==null?void 0:P.call(a,T),o&&n(R,null,[n("span",null,null),n(ke,{active:!!((w=i.value)!=null&&w.length),value:O.value,disabled:t.disabled},a.counter)])])}:void 0})}),Te({},S,C,m)}}),Ne=z({...Fe({falseIcon:"$radioOff",trueIcon:"$radioOn"})},"VRadio"),U=E()({name:"VRadio",props:Ne(),setup(t,e){let{slots:c}=e;return q(()=>{const d=N.filterProps(t);return n(N,D(d,{class:["v-radio",t.class],style:t.style,type:"radio"}),c)}),{}}}),ze=z({height:{type:[Number,String],default:"auto"},...te(),...Pe(Me(),["multiple"]),trueIcon:{type:Q,default:"$radioOn"},falseIcon:{type:Q,default:"$radioOff"},type:{type:String,default:"radio"}},"VRadioGroup"),ee=E()({name:"VRadioGroup",inheritAttrs:!1,props:ze(),emits:{"update:modelValue":t=>!0},setup(t,e){let{attrs:c,slots:d}=e;const a=_e(),u=f(()=>t.id||`radio-group-${a}`),i=le(t,"modelValue");return q(()=>{const[l,F]=ne(c),M=A.filterProps(t),k=N.filterProps(t),y=d.label?d.label({label:t.label,props:{for:u.value}}):t.label;return n(A,D({class:["v-radio-group",t.class],style:t.style},l,M,{modelValue:i.value,"onUpdate:modelValue":b=>i.value=b,id:u.value}),{...d,default:b=>{let{id:p,messagesId:O,isDisabled:S,isReadonly:C}=b;return n(R,null,[y&&n(xe,{id:p.value},{default:()=>[y]}),n(Oe,D(k,{id:p.value,"aria-describedby":O.value,defaultsTarget:"VRadio",trueIcon:t.trueIcon,falseIcon:t.falseIcon,type:t.type,disabled:S.value,readonly:C.value,"aria-labelledby":y?p.value:void 0,multiple:!1},F,{modelValue:i.value,"onUpdate:modelValue":m=>i.value=m}),d)])}})}),{}}}),Ee={name:"NewEvent",data(){return{loggedIn:!1,username:"",password:"",correctUsername:"timeline-admin",correctPassword:"19391945",existingTags:[],mainTagSelectionType:"select",eventType:"moment",today:new Date().toISOString(),loading:!1,formData:{name:"",description:"",date:null,startDate:null,endDate:null,selectedMainTag:"",createdMainTag:"",selectedTags:[],createdTags:"",mapLink:"",image:null}}},methods:{async submitEvent(){this.loading=!0;const t=this.getPayload();if(this.formData.image){const e=new FormData;e.append("image",this.formData.image);const a=(await(await fetch("/image-upload",{method:"POST",body:e})).json()).image_id;t.image=a}await fetch("/create-new-event",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),this.loading=!1,this.$router.push("/thank-you")},getPayload(){const t={name:this.formData.name,description:this.formData.description,embed_link:this.formData.mapLink?this.formData.mapLink.split('"')[1]:"",tags:this.formData.selectedTags.map(e=>parseInt(e))||[],new_tags:this.getNewTags(),main_tag_id:parseInt(this.formData.selectedMainTag)||"",new_main_tag:this.formData.createdMainTag.trim().toLowerCase()||""};return this.eventType==="moment"?t.start_date=this.getDate(this.formData.date):(t.start_date=this.getDate(this.formData.startDate),t.end_date=this.getDate(this.formData.endDate)),t},getDate(t){const e=new Date(t);return new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())).toISOString()},getNewTags(){return this.formData.createdTags?this.formData.createdTags.includes(",")?this.formData.createdTags.split(",").map(t=>t.trim().toLowerCase()):[this.formData.createdTags.trim().toLowerCase()]:""},loginClicked(){this.username===this.correctUsername&&this.password===this.correctPassword?(localStorage.setItem("isLoggedInToTimeline","true"),this.loggedIn=this.isLoggedIn(),this.$emit("loggedInChanged",this.loggedIn)):alert("Incorrect username or password")},isLoggedIn(){return localStorage.getItem("isLoggedInToTimeline")==="true"},async setTags(){await fetch("/tags").then(t=>t.json()).then(t=>{this.existingTags=t.map(e=>({value:e.id.toString(),title:e.name}))})}},async created(){this.loggedIn=this.isLoggedIn(),await this.setTags()}},qe={key:0,class:"login_container"},je={class:"login_box"},Ge={key:0,class:"form_container"},Ye={class:""},Je={class:"optional_information_container"},Ke={class:"map_container"},Qe={key:0,class:"moment_date"},We={key:1,class:"range_dates"},Xe={class:"tags_container"},Ze={class:"main_tag_container"},He={class:"tag_content"},$e={class:"tags"},et={class:"tag_content"};function tt(t,e,c,d,a,u){const i=Re("v-date-input");return V(),I("div",null,[s("form",{onSubmit:e[2]||(e[2]=X((...l)=>u.loginClicked&&u.loginClicked(...l),["prevent"]))},[a.loggedIn?x("",!0):(V(),I("div",qe,[s("div",je,[n(v,{id:"username",modelValue:a.username,"onUpdate:modelValue":e[0]||(e[0]=l=>a.username=l),width:"20rem",label:"Username",name:"username"},null,8,["modelValue"]),n(v,{id:"password",modelValue:a.password,"onUpdate:modelValue":e[1]||(e[1]=l=>a.password=l),width:"20rem",label:"Password",type:"password",name:"password"},null,8,["modelValue"]),n(W,{class:"submit_btn",color:"#5865f2",width:"8rem",type:"submit",block:""},{default:_(()=>e[17]||(e[17]=[H("Submit")])),_:1})])]))],32),a.loggedIn?(V(),I("div",Ge,[e[29]||(e[29]=s("h1",null,"Add New Event",-1)),s("form",{onSubmit:e[16]||(e[16]=X((...l)=>u.submitEvent&&u.submitEvent(...l),["prevent"]))},[e[24]||(e[24]=s("p",null,"I want to create a new event! Yay! What's the event type?",-1)),n(ee,{modelValue:a.eventType,"onUpdate:modelValue":e[3]||(e[3]=l=>a.eventType=l),inline:""},{default:_(()=>[n(U,{label:"Moment (an event that points to a specific date)",value:"moment"}),n(U,{label:"Range (an event that has different start and end dates)",value:"range"})]),_:1},8,["modelValue"]),e[25]||(e[25]=s("h2",{class:"section_title"},"Information",-1)),s("div",Ye,[n(v,{id:"name",modelValue:a.formData.name,"onUpdate:modelValue":e[4]||(e[4]=l=>a.formData.name=l),label:"Event Name","max-width":"30rem",name:"name",required:""},null,8,["modelValue"])]),s("div",null,[n(v,{id:"description",modelValue:a.formData.description,"onUpdate:modelValue":e[5]||(e[5]=l=>a.formData.description=l),label:"Event Description",name:"description"},null,8,["modelValue"])]),e[26]||(e[26]=s("h3",{class:"subsection_title"},"Optional Information",-1)),s("div",Je,[n(Le,{id:"image",modelValue:a.formData.image,"onUpdate:modelValue":e[6]||(e[6]=l=>a.formData.image=l),class:"file_input",label:"Optional: Image",name:"image"},null,8,["modelValue"]),s("div",Ke,[n(v,{id:"map_link",modelValue:a.formData.mapLink,"onUpdate:modelValue":e[7]||(e[7]=l=>a.formData.mapLink=l),label:"Optional: Map Link",name:"map_link"},null,8,["modelValue"]),e[18]||(e[18]=s("p",null,"If you want the event to include a google map, please go to google maps and search for the location. Then click the 'share' icon and go to the 'Embed a map' tab. Copy the provided link and paste it here.",-1))])]),e[27]||(e[27]=s("h2",{class:"section_title"},"Dates",-1)),s("div",null,[a.eventType==="moment"?(V(),I("div",Qe,[n(i,{id:"moment_date",modelValue:a.formData.date,"onUpdate:modelValue":e[8]||(e[8]=l=>a.formData.date=l),max:a.today,required:"",label:"Date",width:"20rem",name:"moment_date"},null,8,["modelValue","max"])])):(V(),I("div",We,[n(i,{id:"start_date",modelValue:a.formData.startDate,"onUpdate:modelValue":e[9]||(e[9]=l=>a.formData.startDate=l),max:a.today,required:"",label:"Start Date",width:"20rem",name:"start_date"},null,8,["modelValue","max"]),n(i,{id:"end_date",modelValue:a.formData.endDate,"onUpdate:modelValue":e[10]||(e[10]=l=>a.formData.endDate=l),max:a.today,required:"",label:"End Date",width:"20rem",name:"end_date"},null,8,["modelValue","max"])]))]),e[28]||(e[28]=s("h2",{class:"section_title"},"Tags",-1)),s("div",Xe,[e[21]||(e[21]=s("h3",{class:"subsection_title"},"Main Tag",-1)),s("div",Ze,[n(ee,{modelValue:a.mainTagSelectionType,"onUpdate:modelValue":e[11]||(e[11]=l=>a.mainTagSelectionType=l),inline:""},{default:_(()=>[n(U,{label:"Select an existing tag",value:"select"}),n(U,{label:"Create a new tag",value:"create"})]),_:1},8,["modelValue"]),s("div",He,[a.existingTags.length?(V(),Z($,{key:0,id:"main_tag",modelValue:a.formData.selectedMainTag,"onUpdate:modelValue":e[12]||(e[12]=l=>a.formData.selectedMainTag=l),required:a.mainTagSelectionType==="select",label:"Select an existing tag",disabled:a.mainTagSelectionType==="create",items:a.existingTags},null,8,["modelValue","required","disabled","items"])):x("",!0),e[19]||(e[19]=s("p",{class:"or"},"OR",-1)),n(v,{id:"main_tag",modelValue:a.formData.createdMainTag,"onUpdate:modelValue":e[13]||(e[13]=l=>a.formData.createdMainTag=l),required:a.mainTagSelectionType==="create",label:"Create a new tag",disabled:a.mainTagSelectionType==="select"},null,8,["modelValue","required","disabled"])])]),e[22]||(e[22]=s("h3",{class:"subsection_title"},"Other Tags",-1)),s("div",$e,[s("div",et,[a.existingTags.length?(V(),Z($,{key:0,modelValue:a.formData.selectedTags,"onUpdate:modelValue":e[14]||(e[14]=l=>a.formData.selectedTags=l),class:"tags_selection",items:a.existingTags,label:"Tags",multiple:""},null,8,["modelValue","items"])):x("",!0),s("div",null,[n(v,{id:"new_tags",modelValue:a.formData.createdTags,"onUpdate:modelValue":e[15]||(e[15]=l=>a.formData.createdTags=l),label:"Add new tags"},null,8,["modelValue"]),e[20]||(e[20]=s("p",null,"Add as many tags as you wish. Use a comma as a separator. For example: war, Germany, battle",-1))])])])]),n(W,{class:"submit_btn",color:"#5865f2",width:"20rem",type:"submit",loading:a.loading,block:""},{default:_(()=>e[23]||(e[23]=[H("Submit")])),_:1},8,["loading"])],32)])):x("",!0)])}const ot=Ue(Ee,[["render",tt],["__scopeId","data-v-29d7f552"]]);export{ot as default};
